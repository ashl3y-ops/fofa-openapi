name: FOFA
version: "1.0.0"
category: Threat Intelligence
uuid: fofa-1234
description: FOFA IP Analysis Integration
vendor: FOFA

config_meta:
  - name: base_url
    type: string
    default: https://fofa.info/api
    required: true
  - name: api_key
    type: password
    required: true
    placeholder: token_xxxx...

actions:
  - name: get_host_info
    display_name: Get Host Info
    input_params:
      - name: ip
        type: string
        required: false
        default: 8.8.8.8
    http:
      method: GET
      url: "{{base_url}}/v1/search/host"
      headers:
        Authorization: "token {{api_key}}"
      query_params:
        q: "{{ip}}"
    output_params:
      - name: results
        type: object

  - name: get_ip_summary
    display_name: Get IP Summary
    input_params:
      - name: ip
        type: string
        required: true
    http:
      method: GET
      url: "{{base_url}}/v1/ip_summary"
      headers:
        Authorization: "token {{api_key}}"
      query_params:
        ip: "{{ip}}"
    output_params:
      - name: ip
        type: string
      - name: country
        type: string
      - name: region
        type: string
      - name: isp
        type: string
      - name: status
        type: number

  - name: get_ip_report
    display_name: Get IP Report
    input_params:
      - name: ip
        type: string
        required: true
    http:
      method: GET
      url: "{{base_url}}/v1/ip_report"
      headers:
        Authorization: "token {{api_key}}"
      query_params:
        ip: "{{ip}}"
    output_params:
      - name: issues
        type: object
      - name: tags
        type: list
      - name: score
        type: object

  - name: get_vpn_info
    display_name: Get VPN Information
    input_params:
      - name: ip
        type: string
        required: true
    http:
      method: GET
      url: "{{base_url}}/v1/vpn_info"
      headers:
        Authorization: "token {{api_key}}"
      query_params:
        ip: "{{ip}}"
    output_params:
      - name: is_vpn
        type: boolean
      - name: is_proxy
        type: boolean
      - name: status
        type: number

  - name: get_malicious_info
    display_name: Get Malicious Info
    input_params:
      - name: ip
        type: string
        required: true
    http:
      method: GET
      url: "{{base_url}}/v1/malicious_info"
      headers:
        Authorization: "token {{api_key}}"
      query_params:
        ip: "{{ip}}"
    output_params:
      - name: is_malicious
        type: boolean
      - name: can_remote_access
        type: boolean
      - name: vulnerability
        type: object
      - name: scanning_record
        type: object
